<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Créer un compte</title>
    <!-- Lien vers la même feuille de style que la page de login -->
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>

<div class="register-container">
    <h2>Créer un nouveau compte</h2>

    <!--
      Le formulaire est lié à un objet "userDto" qui doit être passé par le contrôleur.
      Ceci facilite la gestion des données et des erreurs de validation.
    -->
    <form th:action="@{/register}" th:object="${userDto}" method="post">

        <!-- Prénom -->
        <div class="form-group">
            <label for="firstName">Prénom :</label>
            <input type="text" id="firstName" th:field="*{firstName}" required>
            <!-- Affiche une erreur si le champ 'firstName' est invalide -->
            <div th:if="${#fields.hasErrors('firstName')}" th:errors="*{firstName}" class="error-message"></div>
        </div>

        <!-- Nom -->
        <div class="form-group">
            <label for="lastName">Nom :</label>
            <input type="text" id="lastName" th:field="*{lastName}" required>
            <div th:if="${#fields.hasErrors('lastName')}" th:errors="*{lastName}" class="error-message"></div>
        </div>

        <!-- Email -->
        <div class="form-group">
            <label for="mail">Email :</label>
            <input type="email" id="mail" th:field="*{mail}" required>
            <div th:if="${#fields.hasErrors('mail')}" th:errors="*{mail}" class="error-message"></div>
        </div>

        <!-- Pseudo -->
        <div class="form-group">
            <label for="pseudo">Pseudo :</label>
            <input type="text" id="pseudo" th:field="*{pseudo}" required>
            <div th:if="${#fields.hasErrors('pseudo')}" th:errors="*{pseudo}" class="error-message"></div>
        </div>

        <!-- Username -->
        <div class="form-group">
            <label for="pseudo">Username :</label>
            <input type="text" id="username" th:field="*{username}" required>
            <div th:if="${#fields.hasErrors('username')}" th:errors="*{username}" class="error-message"></div>
        </div>

        <!-- Dob -->
        <div class="form-group">
            <label for="pseudo">Dob :</label>
            <input type="date" id="dob" th:field="*{dob}" required>
            <div th:if="${#fields.hasErrors('dob')}" th:errors="*{dob}" class="error-message"></div>
        </div>

        <!-- Phone -->
        <div class="form-group">
            <label for="phone">Phone :</label>
            <input type="text" id="phone" th:field="*{phone}" required>
            <div th:if="${#fields.hasErrors('phone')}" th:errors="*{phone}" class="error-message"></div>
        </div>

        <!-- Mot de passe -->
        <div class="form-group">
            <label for="password">Mot de passe :</label>
            <input type="password" id="password" th:field="*{password}" required>
            <div th:if="${#fields.hasErrors('password')}" th:errors="*{password}" class="error-message"></div>
        </div>

        <!-- Rôle -->
        <div class="form-group">
            <label for="role">Rôle :</label>
            <select id="role" th:field="*{role}" required>
                <option value="" disabled selected>-- Choisissez un rôle --</option>
                <option value="USER">Utilisateur</option>
                <option value="MODO">Modérateur</option>
                <option value="ADMIN">Administrateur</option>
            </select>
            <div th:if="${#fields.hasErrors('role')}" th:errors="*{role}" class="error-message"></div>
        </div>

        <!-- Jeton CSRF - Obligatoire pour la sécurité -->
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

        <button type="submit" class="btn">S'inscrire</button>
    </form>

    <div class="extra-links">
        <a th:href="@{/login}">Vous avez déjà un compte ? Connectez-vous</a>
    </div>
</div>

</body>
</html>